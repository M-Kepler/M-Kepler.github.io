{"uid":"abda82d163b45dc8","name":"test_ppt2douyin[image_article]","fullName":"apps.ppt2douyin.test_ppt2douyin#test_ppt2douyin","historyId":"a9458fb56e629795ad944536f1a9c902","time":{"start":1721832242172,"stop":1721832344100,"duration":101928},"description":"\n    测试 PPT 发布到 douyin\n    ","descriptionHtml":"<pre><code>测试 PPT 发布到 douyin\n</code></pre>\n","status":"broken","statusMessage":"tenacity.RetryError: RetryError[<Future at 0x7fc3e4553520 state=finished raised TypeError>]","statusTrace":"self = <Retrying object at 0x7fc3de562be0 (stop=<tenacity.stop.stop_after_attempt object at 0x7fc40a322640>, wait=<tenacity.w...0x7fc425e3bbb0>, before=<function before_nothing at 0x7fc4260d23a0>, after=<function after_nothing at 0x7fc4260d2700>)>\nfn = <function PPTTransfer._ppt_trans at 0x7fc40a3293a0>\nargs = (<mypy.apps.ppt2douyin.ppt_transfer.PPTTransfer object at 0x7fc3de5620d0>, '/home/runner/work/github-runner/github-runner/mypy/tests/apps/ppt2douyin/消化内科护士长竞聘.pptx')\nkwargs = {}\nretry_state = <RetryCallState 140479225538208: attempt #10; slept for 0.0; last result: failed (TypeError expected str, bytes or os.PathLike object, not NoneType)>\ndo = <tenacity.DoAttempt object at 0x7fc3e476ee50>\n\n    def __call__(\n        self,\n        fn: t.Callable[..., WrappedFnReturnT],\n        *args: t.Any,\n        **kwargs: t.Any,\n    ) -> WrappedFnReturnT:\n        self.begin()\n    \n        retry_state = RetryCallState(retry_object=self, fn=fn, args=args, kwargs=kwargs)\n        while True:\n            do = self.iter(retry_state=retry_state)\n            if isinstance(do, DoAttempt):\n                try:\n>                   result = fn(*args, **kwargs)\n\n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/tenacity/__init__.py:478: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nmypy/apps/ppt2douyin/ppt_transfer.py:148: in _ppt_trans\n    raise ex\nmypy/apps/ppt2douyin/ppt_transfer.py:145: in _ppt_trans\n    self._ppt_handler(ppt_path, output_filepath)\nmypy/apps/ppt2douyin/ppt_transfer.py:75: in make_ppt2image_article\n    ppt2image(ppt_path=ppt_path,\nmypy/lib/ppt/ppt_handler.py:77: in ppt2image\n    pdf_handler.pdf2images(image_dir=output_dir,\nmypy/lib/pdf/pdf_handler.py:43: in pdf2images\n    _, file_ext = os.path.splitext(self._input_pdf_path)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\np = None\n\n    def splitext(p):\n>       p = os.fspath(p)\nE       TypeError: expected str, bytes or os.PathLike object, not NoneType\n\n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/posixpath.py:118: TypeError\n\nThe above exception was the direct cause of the following exception:\n\npublish_media_type = 'image_article'\n\n    @pytest.mark.parametrize('publish_media_type', [\n        Const.MEDIA_TYPE_IMG_ARTICLE, Const.MEDIA_TYPE_VIDEO],\n        ids=[Const.MEDIA_TYPE_IMG_ARTICLE, Const.MEDIA_TYPE_VIDEO])\n    def test_ppt2douyin(publish_media_type):\n        \"\"\"\n        测试 PPT 发布到 douyin\n        \"\"\"\n        # 修改发布配置\n        set_publish_cfg(config_path=config_path,\n                        settings={\n                            ('publish', 'media_type'): publish_media_type,\n                            ('video_crop', 'with_opening_video'): True,\n                            ('video_crop', 'with_title_on_video'): True,\n                            ('video_crop', 'with_green_screen'): True,\n                            ('video_crop', 'with_h2v'): True,\n                            ('video_crop', 'with_speech'): True,\n                        })\n    \n        # WARNNING 因为要读取当前目录下的 config 文件， 所以不要传入 test_output_dir\n>       main(work_path=curr_dir)\n\nmypy/tests/apps/ppt2douyin/test_ppt2douyin.py:34: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nmypy/apps/ppt2douyin/main.py:135: in main\n    raise ex\nmypy/apps/ppt2douyin/main.py:119: in main\n    ppt_transfer.batch_ppt2transfer()\nmypy/apps/ppt2douyin/ppt_transfer.py:167: in batch_ppt2transfer\n    self._ppt_trans(ppt_file)\n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/tenacity/__init__.py:336: in wrapped_f\n    return copy(f, *args, **kw)\n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/tenacity/__init__.py:475: in __call__\n    do = self.iter(retry_state=retry_state)\n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/tenacity/__init__.py:376: in iter\n    result = action(retry_state)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nrs = <RetryCallState 140479225538208: attempt #10; slept for 0.0; last result: failed (TypeError expected str, bytes or os.PathLike object, not NoneType)>\n\n    def exc_check(rs: \"RetryCallState\") -> None:\n        fut = t.cast(Future, rs.outcome)\n        retry_exc = self.retry_error_cls(fut)\n        if self.reraise:\n            raise retry_exc.reraise()\n>       raise retry_exc from fut.exception()\nE       tenacity.RetryError: RetryError[<Future at 0x7fc3e4553520 state=finished raised TypeError>]\n\n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/tenacity/__init__.py:419: RetryError","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"event_loop_policy","time":{"start":1721831550977,"stop":1721831550977,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"copy_config_to_dir","time":{"start":1721832242170,"stop":1721832242171,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"testStage":{"description":"\n    测试 PPT 发布到 douyin\n    ","status":"broken","statusMessage":"tenacity.RetryError: RetryError[<Future at 0x7fc3e4553520 state=finished raised TypeError>]","statusTrace":"self = <Retrying object at 0x7fc3de562be0 (stop=<tenacity.stop.stop_after_attempt object at 0x7fc40a322640>, wait=<tenacity.w...0x7fc425e3bbb0>, before=<function before_nothing at 0x7fc4260d23a0>, after=<function after_nothing at 0x7fc4260d2700>)>\nfn = <function PPTTransfer._ppt_trans at 0x7fc40a3293a0>\nargs = (<mypy.apps.ppt2douyin.ppt_transfer.PPTTransfer object at 0x7fc3de5620d0>, '/home/runner/work/github-runner/github-runner/mypy/tests/apps/ppt2douyin/消化内科护士长竞聘.pptx')\nkwargs = {}\nretry_state = <RetryCallState 140479225538208: attempt #10; slept for 0.0; last result: failed (TypeError expected str, bytes or os.PathLike object, not NoneType)>\ndo = <tenacity.DoAttempt object at 0x7fc3e476ee50>\n\n    def __call__(\n        self,\n        fn: t.Callable[..., WrappedFnReturnT],\n        *args: t.Any,\n        **kwargs: t.Any,\n    ) -> WrappedFnReturnT:\n        self.begin()\n    \n        retry_state = RetryCallState(retry_object=self, fn=fn, args=args, kwargs=kwargs)\n        while True:\n            do = self.iter(retry_state=retry_state)\n            if isinstance(do, DoAttempt):\n                try:\n>                   result = fn(*args, **kwargs)\n\n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/tenacity/__init__.py:478: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nmypy/apps/ppt2douyin/ppt_transfer.py:148: in _ppt_trans\n    raise ex\nmypy/apps/ppt2douyin/ppt_transfer.py:145: in _ppt_trans\n    self._ppt_handler(ppt_path, output_filepath)\nmypy/apps/ppt2douyin/ppt_transfer.py:75: in make_ppt2image_article\n    ppt2image(ppt_path=ppt_path,\nmypy/lib/ppt/ppt_handler.py:77: in ppt2image\n    pdf_handler.pdf2images(image_dir=output_dir,\nmypy/lib/pdf/pdf_handler.py:43: in pdf2images\n    _, file_ext = os.path.splitext(self._input_pdf_path)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\np = None\n\n    def splitext(p):\n>       p = os.fspath(p)\nE       TypeError: expected str, bytes or os.PathLike object, not NoneType\n\n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/posixpath.py:118: TypeError\n\nThe above exception was the direct cause of the following exception:\n\npublish_media_type = 'image_article'\n\n    @pytest.mark.parametrize('publish_media_type', [\n        Const.MEDIA_TYPE_IMG_ARTICLE, Const.MEDIA_TYPE_VIDEO],\n        ids=[Const.MEDIA_TYPE_IMG_ARTICLE, Const.MEDIA_TYPE_VIDEO])\n    def test_ppt2douyin(publish_media_type):\n        \"\"\"\n        测试 PPT 发布到 douyin\n        \"\"\"\n        # 修改发布配置\n        set_publish_cfg(config_path=config_path,\n                        settings={\n                            ('publish', 'media_type'): publish_media_type,\n                            ('video_crop', 'with_opening_video'): True,\n                            ('video_crop', 'with_title_on_video'): True,\n                            ('video_crop', 'with_green_screen'): True,\n                            ('video_crop', 'with_h2v'): True,\n                            ('video_crop', 'with_speech'): True,\n                        })\n    \n        # WARNNING 因为要读取当前目录下的 config 文件， 所以不要传入 test_output_dir\n>       main(work_path=curr_dir)\n\nmypy/tests/apps/ppt2douyin/test_ppt2douyin.py:34: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nmypy/apps/ppt2douyin/main.py:135: in main\n    raise ex\nmypy/apps/ppt2douyin/main.py:119: in main\n    ppt_transfer.batch_ppt2transfer()\nmypy/apps/ppt2douyin/ppt_transfer.py:167: in batch_ppt2transfer\n    self._ppt_trans(ppt_file)\n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/tenacity/__init__.py:336: in wrapped_f\n    return copy(f, *args, **kw)\n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/tenacity/__init__.py:475: in __call__\n    do = self.iter(retry_state=retry_state)\n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/tenacity/__init__.py:376: in iter\n    result = action(retry_state)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nrs = <RetryCallState 140479225538208: attempt #10; slept for 0.0; last result: failed (TypeError expected str, bytes or os.PathLike object, not NoneType)>\n\n    def exc_check(rs: \"RetryCallState\") -> None:\n        fut = t.cast(Future, rs.outcome)\n        retry_exc = self.retry_error_cls(fut)\n        if self.reraise:\n            raise retry_exc.reraise()\n>       raise retry_exc from fut.exception()\nE       tenacity.RetryError: RetryError[<Future at 0x7fc3e4553520 state=finished raised TypeError>]\n\n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/tenacity/__init__.py:419: RetryError","steps":[],"attachments":[{"uid":"8a82629bf3005eff","name":"log","source":"8a82629bf3005eff.txt","type":"text/plain","size":22413}],"parameters":[],"shouldDisplayMessage":true,"stepsCount":0,"attachmentsCount":1,"hasContent":true,"attachmentStep":false},"afterStages":[{"name":"copy_config_to_dir::finish_callback","time":{"start":1721832361456,"stop":1721832361457,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"labels":[{"name":"parentSuite","value":"apps.ppt2douyin"},{"name":"suite","value":"test_ppt2douyin"},{"name":"host","value":"fv-az1206-225"},{"name":"thread","value":"8866-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"apps.ppt2douyin.test_ppt2douyin"},{"name":"resultFormat","value":"allure2"}],"parameters":[{"name":"publish_media_type","value":"'image_article'"}],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[{"name":"Test defects","matchedStatuses":[],"flaky":false}],"tags":[]},"source":"abda82d163b45dc8.json","parameterValues":["'image_article'"]}