{"uid":"d8cf4edec7645db4","name":"test_ppt2image","fullName":"lib.ppt.test_ppt_handler#test_ppt2image","historyId":"87605ca98349d50bd1dce5b616e3e4a3","time":{"start":1721836318783,"stop":1721836324043,"duration":5260},"description":"\n    测试 PPT 转成图片\n    ","descriptionHtml":"<pre><code>测试 PPT 转成图片\n</code></pre>\n","status":"broken","statusMessage":"TypeError: expected str, bytes or os.PathLike object, not NoneType","statusTrace":"test_output_dir = '/home/runner/work/github-runner/github-runner/mypy/tests/lib/ppt/_out/test_ppt_handler'\n\n    def test_ppt2image(test_output_dir):\n        \"\"\"\n        测试 PPT 转成图片\n        \"\"\"\n        # 把测试文件拷贝到当前函数名称的目录下\n        output_dir = os.path.join(\n            test_output_dir, curr_func_name())\n        with FileUtil.copy_file_context(Assets.ppt, output_dir) as test_file:\n            # ppt 转成视频的文件名\n>           ppt2image(ppt_path=test_file, output_dir=output_dir)\n\nmypy/tests/lib/ppt/test_ppt_handler.py:42: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nmypy/lib/ppt/ppt_handler.py:77: in ppt2image\n    pdf_handler.pdf2images(image_dir=output_dir,\nmypy/lib/pdf/pdf_handler.py:43: in pdf2images\n    _, file_ext = os.path.splitext(self._input_pdf_path)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\np = None\n\n    def splitext(p):\n>       p = os.fspath(p)\nE       TypeError: expected str, bytes or os.PathLike object, not NoneType\n\n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/posixpath.py:118: TypeError","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"event_loop_policy","time":{"start":1721831550977,"stop":1721831550977,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"copy_config_to_dir","time":{"start":1721836313409,"stop":1721836313411,"duration":2},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"test_output_dir","time":{"start":1721836313411,"stop":1721836313411,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"testStage":{"description":"\n    测试 PPT 转成图片\n    ","status":"broken","statusMessage":"TypeError: expected str, bytes or os.PathLike object, not NoneType","statusTrace":"test_output_dir = '/home/runner/work/github-runner/github-runner/mypy/tests/lib/ppt/_out/test_ppt_handler'\n\n    def test_ppt2image(test_output_dir):\n        \"\"\"\n        测试 PPT 转成图片\n        \"\"\"\n        # 把测试文件拷贝到当前函数名称的目录下\n        output_dir = os.path.join(\n            test_output_dir, curr_func_name())\n        with FileUtil.copy_file_context(Assets.ppt, output_dir) as test_file:\n            # ppt 转成视频的文件名\n>           ppt2image(ppt_path=test_file, output_dir=output_dir)\n\nmypy/tests/lib/ppt/test_ppt_handler.py:42: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nmypy/lib/ppt/ppt_handler.py:77: in ppt2image\n    pdf_handler.pdf2images(image_dir=output_dir,\nmypy/lib/pdf/pdf_handler.py:43: in pdf2images\n    _, file_ext = os.path.splitext(self._input_pdf_path)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\np = None\n\n    def splitext(p):\n>       p = os.fspath(p)\nE       TypeError: expected str, bytes or os.PathLike object, not NoneType\n\n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/posixpath.py:118: TypeError","steps":[],"attachments":[{"uid":"f9f4eda33f380d7","name":"log","source":"f9f4eda33f380d7.txt","type":"text/plain","size":790}],"parameters":[],"shouldDisplayMessage":true,"stepsCount":0,"attachmentsCount":1,"hasContent":true,"attachmentStep":false},"afterStages":[{"name":"test_output_dir::0","time":{"start":1721836329353,"stop":1721836329354,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"copy_config_to_dir::finish_callback","time":{"start":1721836329354,"stop":1721836329355,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"labels":[{"name":"tag","value":"ppt"},{"name":"parentSuite","value":"lib.ppt"},{"name":"suite","value":"test_ppt_handler"},{"name":"host","value":"fv-az1206-225"},{"name":"thread","value":"8866-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"lib.ppt.test_ppt_handler"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[{"name":"Test defects","matchedStatuses":[],"flaky":false}],"tags":["ppt"]},"source":"d8cf4edec7645db4.json","parameterValues":[]}