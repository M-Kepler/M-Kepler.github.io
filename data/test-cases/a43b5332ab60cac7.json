{"uid":"a43b5332ab60cac7","name":"test_publish_app","fullName":"lib.xiaohongshu.test_xiaohongshu_publish_app#test_publish_app","historyId":"27c41efb80f7df6c6211821eb09989db","time":{"start":1714721022726,"stop":1714721022735,"duration":9},"status":"broken","statusMessage":"Exception: 获取 [XiaohongshuPublishApp] 发布 [image_article] 处理器失败","statusTrace":"def test_publish_app():\n>       XiaohongshuPublishApp(curr_dir).publish(\n            upload_filepath=Assets.video)\n\nmypy/tests/lib/xiaohongshu/test_xiaohongshu_publish_app.py:9: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nmypy/lib/playwright/publish_app.py:143: in publish\n    asyncio.run(\n/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/asyncio/runners.py:44: in run\n    return loop.run_until_complete(main)\n/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/asyncio/base_events.py:616: in run_until_complete\n    return future.result()\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <mypy.lib.xiaohongshu.publish_app.XiaohongshuPublishApp object at 0x7f60a25d6e20>\nupload_filepath = '/home/runner/work/Python/Python/mypy/assets/media/ted.mp4'\npub_cfg = <mypy.lib.playwright.publish_config.PublishConfig object at 0x7f60915e8790>\nvideo_title = None, manual = False\n\n    async def async_publish(self, upload_filepath: str, pub_cfg: PublishConfig = None,\n                            video_title: str = None, manual: bool = False):\n        \"\"\"\n        处理发布过程\n    \n        :param video_title: 标题，默认视频文件名称作为标题\n        :param pub_cfg: 发布配置，如果为空则会读取 {self._work_path}/config/config.ini 下的发布配置\n        :param manual: 是否是 console 提示的形式，提示手动输入发布配置\n        :param publish_time: 发布时间，不传则发布时间默认为当前时间加三小时\n    \n        \"\"\"\n    \n        cookie_list = FileUtil.list_files_by_ext(\n            find_path=self._cookie_dir, find_exts=[\".json\"])\n        if not cookie_list:\n            self._logger.warning('在 %s 下未找到 cookie', self._cookie_dir)\n            raise Exception(f'在 {self._cookie_dir} 下未找到 cookie')\n    \n        # 发布配置\n        if not pub_cfg:\n            # 如果没传入发布配置，则从终端提示获取，或者从配置文件读取\n            pub_cfg = PublishIniConfigHelper(\n                work_path=self._work_path).read_publish_ini_cfg(video_title)\n            if manual:\n                pub_cfg = self._console_set_publish_cfg()\n    \n        if not self._is_publish_datetime_ok(pub_cfg.publish_time, pub_cfg.publish_mod):\n            raise PublishTimeCheckError()\n    \n        index = 0\n        for cookie_path in cookie_list:\n            index += 1\n            self._logger.info(\"正在使用 [%s] 发布作品，当前账号排序: [%s]\",\n                              os.path.basename(cookie_path), index)\n            publish_helper = self.get_publish_helper(cookie_path=cookie_path,\n                                                     upload_filepath=upload_filepath,\n                                                     pub_cfg=pub_cfg)\n            if not publish_helper:\n                err_msg = (f'获取 [{self.__class__.__name__}] '\n                           f'发布 [{pub_cfg.media_type}] 处理器失败')\n>               raise Exception(err_msg)\nE               Exception: 获取 [XiaohongshuPublishApp] 发布 [image_article] 处理器失败\n\nmypy/lib/playwright/publish_app.py:138: Exception","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"event_loop_policy","time":{"start":1714717237980,"stop":1714717237980,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false,"shouldDisplayMessage":false},{"name":"copy_config_to_dir","time":{"start":1714721022724,"stop":1714721022725,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false,"shouldDisplayMessage":false}],"testStage":{"status":"broken","statusMessage":"Exception: 获取 [XiaohongshuPublishApp] 发布 [image_article] 处理器失败","statusTrace":"def test_publish_app():\n>       XiaohongshuPublishApp(curr_dir).publish(\n            upload_filepath=Assets.video)\n\nmypy/tests/lib/xiaohongshu/test_xiaohongshu_publish_app.py:9: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nmypy/lib/playwright/publish_app.py:143: in publish\n    asyncio.run(\n/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/asyncio/runners.py:44: in run\n    return loop.run_until_complete(main)\n/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/asyncio/base_events.py:616: in run_until_complete\n    return future.result()\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <mypy.lib.xiaohongshu.publish_app.XiaohongshuPublishApp object at 0x7f60a25d6e20>\nupload_filepath = '/home/runner/work/Python/Python/mypy/assets/media/ted.mp4'\npub_cfg = <mypy.lib.playwright.publish_config.PublishConfig object at 0x7f60915e8790>\nvideo_title = None, manual = False\n\n    async def async_publish(self, upload_filepath: str, pub_cfg: PublishConfig = None,\n                            video_title: str = None, manual: bool = False):\n        \"\"\"\n        处理发布过程\n    \n        :param video_title: 标题，默认视频文件名称作为标题\n        :param pub_cfg: 发布配置，如果为空则会读取 {self._work_path}/config/config.ini 下的发布配置\n        :param manual: 是否是 console 提示的形式，提示手动输入发布配置\n        :param publish_time: 发布时间，不传则发布时间默认为当前时间加三小时\n    \n        \"\"\"\n    \n        cookie_list = FileUtil.list_files_by_ext(\n            find_path=self._cookie_dir, find_exts=[\".json\"])\n        if not cookie_list:\n            self._logger.warning('在 %s 下未找到 cookie', self._cookie_dir)\n            raise Exception(f'在 {self._cookie_dir} 下未找到 cookie')\n    \n        # 发布配置\n        if not pub_cfg:\n            # 如果没传入发布配置，则从终端提示获取，或者从配置文件读取\n            pub_cfg = PublishIniConfigHelper(\n                work_path=self._work_path).read_publish_ini_cfg(video_title)\n            if manual:\n                pub_cfg = self._console_set_publish_cfg()\n    \n        if not self._is_publish_datetime_ok(pub_cfg.publish_time, pub_cfg.publish_mod):\n            raise PublishTimeCheckError()\n    \n        index = 0\n        for cookie_path in cookie_list:\n            index += 1\n            self._logger.info(\"正在使用 [%s] 发布作品，当前账号排序: [%s]\",\n                              os.path.basename(cookie_path), index)\n            publish_helper = self.get_publish_helper(cookie_path=cookie_path,\n                                                     upload_filepath=upload_filepath,\n                                                     pub_cfg=pub_cfg)\n            if not publish_helper:\n                err_msg = (f'获取 [{self.__class__.__name__}] '\n                           f'发布 [{pub_cfg.media_type}] 处理器失败')\n>               raise Exception(err_msg)\nE               Exception: 获取 [XiaohongshuPublishApp] 发布 [image_article] 处理器失败\n\nmypy/lib/playwright/publish_app.py:138: Exception","steps":[],"attachments":[{"uid":"d3bd070e4e09982","name":"log","source":"d3bd070e4e09982.txt","type":"text/plain","size":338}],"parameters":[],"stepsCount":0,"attachmentsCount":1,"hasContent":true,"attachmentStep":false,"shouldDisplayMessage":true},"afterStages":[{"name":"copy_config_to_dir::finish_callback","time":{"start":1714721022878,"stop":1714721022878,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false,"shouldDisplayMessage":false}],"labels":[{"name":"parentSuite","value":"lib.xiaohongshu"},{"name":"suite","value":"test_xiaohongshu_publish_app"},{"name":"host","value":"fv-az1188-510"},{"name":"thread","value":"6382-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"lib.xiaohongshu.test_xiaohongshu_publish_app"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[{"name":"Test defects","matchedStatuses":[],"flaky":false}],"tags":[]},"source":"a43b5332ab60cac7.json","parameterValues":[]}