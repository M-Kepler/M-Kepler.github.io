{"uid":"cc5e3820952bc760","name":"test_douyin2douyin","fullName":"apps.douyin2douyin.test_douyin2douyin#test_douyin2douyin","historyId":"9c3088b85c6e06877d27a19ba286db3e","time":{"start":1726826412357,"stop":1726826518393,"duration":106036},"description":"\n    测试 douyin 视频搬运（防查重处理）\n    ","descriptionHtml":"<pre><code>测试 douyin 视频搬运（防查重处理）\n</code></pre>\n","status":"skipped","statusMessage":"XFAIL API 有限制，可能会获取 cookie 失败\n\nException: get_douyin_hot_music_video fail","statusTrace":"@pytest.mark.app\n    @pytest.mark.douyin\n    @pytest.mark.xfail(reason='API 有限制，可能会获取 cookie 失败')\n    def test_douyin2douyin():\n        \"\"\"\n        测试 douyin 视频搬运（防查重处理）\n        \"\"\"\n>       video_path = main(curr_dir)\n\nmypy/tests/apps/douyin2douyin/test_douyin2douyin.py:18: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nmypy/apps/douyin2douyin/main.py:34: in main\n    video_id, video_path = api.handle()\nmypy/apps/douyin2douyin/hot_douyin_handler.py:271: in handle\n    raise ex\nmypy/apps/douyin2douyin/hot_douyin_handler.py:262: in handle\n    video_url = self._get_douyin_hot_music_video()\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <mypy.apps.douyin2douyin.hot_douyin_handler.HotDouyinHandler object at 0x7f9ffb738100>\n\n    def _get_douyin_hot_music_video(self):\n        \"\"\"\n        获取抖音音乐榜单下的热门视频\n        \"\"\"\n        while True:\n            jd, res = self._get_douyin_music_video()\n            if not isinstance(jd, int):\n                dd = jd.sample()\n                index = dd.index.values[0]\n                video_list = res['aweme_list'][index]\n                aweme_id = res['aweme_list'][index]['aweme_id']\n                if self._is_video_published(aweme_id):\n                    LOG.warning('该视频: %s 已经发送过了本次不再发送', aweme_id)\n                    continue\n            elif jd == 101:\n                LOG.info(\"所有过滤的限制条件都不满足，可以搬运\")\n            elif jd == 1:\n>               raise Exception('get_douyin_hot_music_video fail')\nE               Exception: get_douyin_hot_music_video fail\n\nmypy/apps/douyin2douyin/hot_douyin_handler.py:190: Exception","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"event_loop_policy","time":{"start":1726825585676,"stop":1726825585676,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"copy_config_to_dir","time":{"start":1726826412355,"stop":1726826412357,"duration":2},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"testStage":{"description":"\n    测试 douyin 视频搬运（防查重处理）\n    ","status":"skipped","statusMessage":"XFAIL API 有限制，可能会获取 cookie 失败\n\nException: get_douyin_hot_music_video fail","statusTrace":"@pytest.mark.app\n    @pytest.mark.douyin\n    @pytest.mark.xfail(reason='API 有限制，可能会获取 cookie 失败')\n    def test_douyin2douyin():\n        \"\"\"\n        测试 douyin 视频搬运（防查重处理）\n        \"\"\"\n>       video_path = main(curr_dir)\n\nmypy/tests/apps/douyin2douyin/test_douyin2douyin.py:18: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nmypy/apps/douyin2douyin/main.py:34: in main\n    video_id, video_path = api.handle()\nmypy/apps/douyin2douyin/hot_douyin_handler.py:271: in handle\n    raise ex\nmypy/apps/douyin2douyin/hot_douyin_handler.py:262: in handle\n    video_url = self._get_douyin_hot_music_video()\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <mypy.apps.douyin2douyin.hot_douyin_handler.HotDouyinHandler object at 0x7f9ffb738100>\n\n    def _get_douyin_hot_music_video(self):\n        \"\"\"\n        获取抖音音乐榜单下的热门视频\n        \"\"\"\n        while True:\n            jd, res = self._get_douyin_music_video()\n            if not isinstance(jd, int):\n                dd = jd.sample()\n                index = dd.index.values[0]\n                video_list = res['aweme_list'][index]\n                aweme_id = res['aweme_list'][index]['aweme_id']\n                if self._is_video_published(aweme_id):\n                    LOG.warning('该视频: %s 已经发送过了本次不再发送', aweme_id)\n                    continue\n            elif jd == 101:\n                LOG.info(\"所有过滤的限制条件都不满足，可以搬运\")\n            elif jd == 1:\n>               raise Exception('get_douyin_hot_music_video fail')\nE               Exception: get_douyin_hot_music_video fail\n\nmypy/apps/douyin2douyin/hot_douyin_handler.py:190: Exception","steps":[],"attachments":[{"uid":"950284a94b50a48e","name":"log","source":"950284a94b50a48e.txt","type":"text/plain","size":7141}],"parameters":[],"shouldDisplayMessage":true,"stepsCount":0,"attachmentsCount":1,"hasContent":true,"attachmentStep":false},"afterStages":[{"name":"copy_config_to_dir::finish_callback","time":{"start":1726826518413,"stop":1726826518414,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"labels":[{"name":"tag","value":"@pytest.mark.xfail(reason='API 有限制，可能会获取 cookie 失败')"},{"name":"tag","value":"douyin"},{"name":"tag","value":"app"},{"name":"parentSuite","value":"apps.douyin2douyin"},{"name":"suite","value":"test_douyin2douyin"},{"name":"host","value":"fv-az654-555"},{"name":"thread","value":"9906-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"apps.douyin2douyin.test_douyin2douyin"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[],"tags":["app","@pytest.mark.xfail(reason='API 有限制，可能会获取 cookie 失败')","douyin"]},"source":"cc5e3820952bc760.json","parameterValues":[]}