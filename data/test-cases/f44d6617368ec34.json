{"uid":"f44d6617368ec34","name":"test_video_handler[RegisteredNurseRN]","fullName":"lib.youtube.test_y2_video_handler#test_video_handler","historyId":"e463c1f171385dae8d8242351866f29a","time":{"start":1729603749055,"stop":1729603750010,"duration":955},"description":"\n    测试 youtu 视频剪辑\n    ","descriptionHtml":"<pre><code>测试 youtu 视频剪辑\n</code></pre>\n","status":"broken","statusMessage":"yt_dlp.utils.DownloadError: ERROR: [youtube] c9hWEA9fiNQ: Sign in to confirm you’re not a bot. This helps protect our community. Learn more","statusTrace":"self = <yt_dlp.YoutubeDL.YoutubeDL object at 0x7fb89ed46c10>\nargs = ('https://www.youtube.com/watch?v=c9hWEA9fiNQ', <yt_dlp.extractor.youtube.YoutubeIE object at 0x7fb89ed46190>, False, {}, True)\nkwargs = {}\n\n    @functools.wraps(func)\n    def wrapper(self, *args, **kwargs):\n        while True:\n            try:\n>               return func(self, *args, **kwargs)\n\n/opt/hostedtoolcache/Python/3.9.20/x64/lib/python3.9/site-packages/yt_dlp/YoutubeDL.py:1625: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/opt/hostedtoolcache/Python/3.9.20/x64/lib/python3.9/site-packages/yt_dlp/YoutubeDL.py:1760: in __extract_info\n    ie_result = ie.extract(url)\n/opt/hostedtoolcache/Python/3.9.20/x64/lib/python3.9/site-packages/yt_dlp/extractor/common.py:741: in extract\n    ie_result = self._real_extract(url)\n/opt/hostedtoolcache/Python/3.9.20/x64/lib/python3.9/site-packages/yt_dlp/extractor/youtube.py:4671: in _real_extract\n    self.raise_no_formats(reason, expected=True)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <yt_dlp.extractor.youtube.YoutubeIE object at 0x7fb89ed46190>\nmsg = 'Sign in to confirm you’re not a bot. This helps protect our community. Learn more'\nexpected = True, video_id = None\n\n    def raise_no_formats(self, msg, expected=False, video_id=None):\n        if expected and (\n                self.get_param('ignore_no_formats_error') or self.get_param('wait_for_video')):\n            self.report_warning(msg, video_id)\n        elif isinstance(msg, ExtractorError):\n            raise msg\n        else:\n>           raise ExtractorError(msg, expected=expected, video_id=video_id)\nE           yt_dlp.utils.ExtractorError: [youtube] c9hWEA9fiNQ: Sign in to confirm you’re not a bot. This helps protect our community. Learn more\n\n/opt/hostedtoolcache/Python/3.9.20/x64/lib/python3.9/site-packages/yt_dlp/extractor/common.py:1275: ExtractorError\n\nDuring handling of the above exception, another exception occurred:\n\ntest_output_dir = '/home/runner/work/github-runner/github-runner/mypy/tests/lib/youtube/_out/test_y2_video_handler'\nvideo_url = 'https://www.youtube.com/watch?v=c9hWEA9fiNQ'\n\n    @pytest.mark.parametrize(\n        'video_url',\n        ['https://www.youtube.com/shorts/B0lkyu2NFnA',\n         'https://www.youtube.com/shorts/3OSwmeCuq_0',\n         'https://www.youtube.com/watch?v=mAxFB3vbt7c',\n         'https://www.youtube.com/watch?v=c9hWEA9fiNQ',\n         'https://www.youtube.com/watch?v=MWIeswvua1I'],\n        ids=['SciePro', 'SlideSkills', 'TedEd', 'RegisteredNurseRN', 'vertical_video'])\n    def test_video_handler(test_output_dir, video_url):\n        \"\"\"\n        测试 youtu 视频剪辑\n        \"\"\"\n        work_path = os.path.join(test_output_dir, curr_func_name())\n        api = Y2VideoHandler(work_path=work_path,\n                             channel_id=YouTube(video_url).channel_id,\n                             video_url=video_url,\n                             ffmpeg_log_output=True)\n>       _, video_fullpath = api.get_video(clean_download=False)\n\nmypy/tests/lib/youtube/test_y2_video_handler.py:30: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nmypy/lib/youtube/y2_video_handler.py:292: in get_video\n    y2_api = YtdlpHelper(video_url=self._video_url,\nmypy/lib/youtube/ytdlp_helper.py:75: in __init__\n    self._title, self._video_id, self._publish_date = get_video_info(\nmypy/lib/youtube/ytdlp_helper.py:62: in get_video_info\n    info_dict = ydl.extract_info(\n/opt/hostedtoolcache/Python/3.9.20/x64/lib/python3.9/site-packages/yt_dlp/YoutubeDL.py:1614: in extract_info\n    return self.__extract_info(url, self.get_info_extractor(key), download, extra_info, process)\n/opt/hostedtoolcache/Python/3.9.20/x64/lib/python3.9/site-packages/yt_dlp/YoutubeDL.py:1643: in wrapper\n    self.report_error(str(e), e.format_traceback())\n/opt/hostedtoolcache/Python/3.9.20/x64/lib/python3.9/site-packages/yt_dlp/YoutubeDL.py:1091: in report_error\n    self.trouble(f'{self._format_err(\"ERROR:\", self.Styles.ERROR)} {message}', *args, **kwargs)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <yt_dlp.YoutubeDL.YoutubeDL object at 0x7fb89ed46c10>\nmessage = 'ERROR: [youtube] c9hWEA9fiNQ: Sign in to confirm you’re not a bot. This helps protect our community. Learn more'\ntb = '  File \"/opt/hostedtoolcache/Python/3.9.20/x64/lib/python3.9/site-packages/yt_dlp/extractor/common.py\", line 741, in ...ctor/common.py\", line 1275, in raise_no_formats\\n    raise ExtractorError(msg, expected=expected, video_id=video_id)\\n'\nis_error = True\n\n    def trouble(self, message=None, tb=None, is_error=True):\n        \"\"\"Determine action to take when a download problem appears.\n    \n        Depending on if the downloader has been configured to ignore\n        download errors or not, this method may throw an exception or\n        not when errors are found, after printing the message.\n    \n        @param tb          If given, is additional traceback information\n        @param is_error    Whether to raise error according to ignorerrors\n        \"\"\"\n        if message is not None:\n            self.to_stderr(message)\n        if self.params.get('verbose'):\n            if tb is None:\n                if sys.exc_info()[0]:  # if .trouble has been called from an except block\n                    tb = ''\n                    if hasattr(sys.exc_info()[1], 'exc_info') and sys.exc_info()[1].exc_info[0]:\n                        tb += ''.join(traceback.format_exception(*sys.exc_info()[1].exc_info))\n                    tb += encode_compat_str(traceback.format_exc())\n                else:\n                    tb_data = traceback.format_list(traceback.extract_stack())\n                    tb = ''.join(tb_data)\n            if tb:\n                self.to_stderr(tb)\n        if not is_error:\n            return\n        if not self.params.get('ignoreerrors'):\n            if sys.exc_info()[0] and hasattr(sys.exc_info()[1], 'exc_info') and sys.exc_info()[1].exc_info[0]:\n                exc_info = sys.exc_info()[1].exc_info\n            else:\n                exc_info = sys.exc_info()\n>           raise DownloadError(message, exc_info)\nE           yt_dlp.utils.DownloadError: ERROR: [youtube] c9hWEA9fiNQ: Sign in to confirm you’re not a bot. This helps protect our community. Learn more\n\n/opt/hostedtoolcache/Python/3.9.20/x64/lib/python3.9/site-packages/yt_dlp/YoutubeDL.py:1030: DownloadError","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"event_loop_policy","time":{"start":1729597033245,"stop":1729597033245,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"copy_config_to_dir","time":{"start":1729603744471,"stop":1729603744473,"duration":2},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"test_output_dir","time":{"start":1729603744473,"stop":1729603744473,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"testStage":{"description":"\n    测试 youtu 视频剪辑\n    ","status":"broken","statusMessage":"yt_dlp.utils.DownloadError: ERROR: [youtube] c9hWEA9fiNQ: Sign in to confirm you’re not a bot. This helps protect our community. Learn more","statusTrace":"self = <yt_dlp.YoutubeDL.YoutubeDL object at 0x7fb89ed46c10>\nargs = ('https://www.youtube.com/watch?v=c9hWEA9fiNQ', <yt_dlp.extractor.youtube.YoutubeIE object at 0x7fb89ed46190>, False, {}, True)\nkwargs = {}\n\n    @functools.wraps(func)\n    def wrapper(self, *args, **kwargs):\n        while True:\n            try:\n>               return func(self, *args, **kwargs)\n\n/opt/hostedtoolcache/Python/3.9.20/x64/lib/python3.9/site-packages/yt_dlp/YoutubeDL.py:1625: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/opt/hostedtoolcache/Python/3.9.20/x64/lib/python3.9/site-packages/yt_dlp/YoutubeDL.py:1760: in __extract_info\n    ie_result = ie.extract(url)\n/opt/hostedtoolcache/Python/3.9.20/x64/lib/python3.9/site-packages/yt_dlp/extractor/common.py:741: in extract\n    ie_result = self._real_extract(url)\n/opt/hostedtoolcache/Python/3.9.20/x64/lib/python3.9/site-packages/yt_dlp/extractor/youtube.py:4671: in _real_extract\n    self.raise_no_formats(reason, expected=True)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <yt_dlp.extractor.youtube.YoutubeIE object at 0x7fb89ed46190>\nmsg = 'Sign in to confirm you’re not a bot. This helps protect our community. Learn more'\nexpected = True, video_id = None\n\n    def raise_no_formats(self, msg, expected=False, video_id=None):\n        if expected and (\n                self.get_param('ignore_no_formats_error') or self.get_param('wait_for_video')):\n            self.report_warning(msg, video_id)\n        elif isinstance(msg, ExtractorError):\n            raise msg\n        else:\n>           raise ExtractorError(msg, expected=expected, video_id=video_id)\nE           yt_dlp.utils.ExtractorError: [youtube] c9hWEA9fiNQ: Sign in to confirm you’re not a bot. This helps protect our community. Learn more\n\n/opt/hostedtoolcache/Python/3.9.20/x64/lib/python3.9/site-packages/yt_dlp/extractor/common.py:1275: ExtractorError\n\nDuring handling of the above exception, another exception occurred:\n\ntest_output_dir = '/home/runner/work/github-runner/github-runner/mypy/tests/lib/youtube/_out/test_y2_video_handler'\nvideo_url = 'https://www.youtube.com/watch?v=c9hWEA9fiNQ'\n\n    @pytest.mark.parametrize(\n        'video_url',\n        ['https://www.youtube.com/shorts/B0lkyu2NFnA',\n         'https://www.youtube.com/shorts/3OSwmeCuq_0',\n         'https://www.youtube.com/watch?v=mAxFB3vbt7c',\n         'https://www.youtube.com/watch?v=c9hWEA9fiNQ',\n         'https://www.youtube.com/watch?v=MWIeswvua1I'],\n        ids=['SciePro', 'SlideSkills', 'TedEd', 'RegisteredNurseRN', 'vertical_video'])\n    def test_video_handler(test_output_dir, video_url):\n        \"\"\"\n        测试 youtu 视频剪辑\n        \"\"\"\n        work_path = os.path.join(test_output_dir, curr_func_name())\n        api = Y2VideoHandler(work_path=work_path,\n                             channel_id=YouTube(video_url).channel_id,\n                             video_url=video_url,\n                             ffmpeg_log_output=True)\n>       _, video_fullpath = api.get_video(clean_download=False)\n\nmypy/tests/lib/youtube/test_y2_video_handler.py:30: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nmypy/lib/youtube/y2_video_handler.py:292: in get_video\n    y2_api = YtdlpHelper(video_url=self._video_url,\nmypy/lib/youtube/ytdlp_helper.py:75: in __init__\n    self._title, self._video_id, self._publish_date = get_video_info(\nmypy/lib/youtube/ytdlp_helper.py:62: in get_video_info\n    info_dict = ydl.extract_info(\n/opt/hostedtoolcache/Python/3.9.20/x64/lib/python3.9/site-packages/yt_dlp/YoutubeDL.py:1614: in extract_info\n    return self.__extract_info(url, self.get_info_extractor(key), download, extra_info, process)\n/opt/hostedtoolcache/Python/3.9.20/x64/lib/python3.9/site-packages/yt_dlp/YoutubeDL.py:1643: in wrapper\n    self.report_error(str(e), e.format_traceback())\n/opt/hostedtoolcache/Python/3.9.20/x64/lib/python3.9/site-packages/yt_dlp/YoutubeDL.py:1091: in report_error\n    self.trouble(f'{self._format_err(\"ERROR:\", self.Styles.ERROR)} {message}', *args, **kwargs)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <yt_dlp.YoutubeDL.YoutubeDL object at 0x7fb89ed46c10>\nmessage = 'ERROR: [youtube] c9hWEA9fiNQ: Sign in to confirm you’re not a bot. This helps protect our community. Learn more'\ntb = '  File \"/opt/hostedtoolcache/Python/3.9.20/x64/lib/python3.9/site-packages/yt_dlp/extractor/common.py\", line 741, in ...ctor/common.py\", line 1275, in raise_no_formats\\n    raise ExtractorError(msg, expected=expected, video_id=video_id)\\n'\nis_error = True\n\n    def trouble(self, message=None, tb=None, is_error=True):\n        \"\"\"Determine action to take when a download problem appears.\n    \n        Depending on if the downloader has been configured to ignore\n        download errors or not, this method may throw an exception or\n        not when errors are found, after printing the message.\n    \n        @param tb          If given, is additional traceback information\n        @param is_error    Whether to raise error according to ignorerrors\n        \"\"\"\n        if message is not None:\n            self.to_stderr(message)\n        if self.params.get('verbose'):\n            if tb is None:\n                if sys.exc_info()[0]:  # if .trouble has been called from an except block\n                    tb = ''\n                    if hasattr(sys.exc_info()[1], 'exc_info') and sys.exc_info()[1].exc_info[0]:\n                        tb += ''.join(traceback.format_exception(*sys.exc_info()[1].exc_info))\n                    tb += encode_compat_str(traceback.format_exc())\n                else:\n                    tb_data = traceback.format_list(traceback.extract_stack())\n                    tb = ''.join(tb_data)\n            if tb:\n                self.to_stderr(tb)\n        if not is_error:\n            return\n        if not self.params.get('ignoreerrors'):\n            if sys.exc_info()[0] and hasattr(sys.exc_info()[1], 'exc_info') and sys.exc_info()[1].exc_info[0]:\n                exc_info = sys.exc_info()[1].exc_info\n            else:\n                exc_info = sys.exc_info()\n>           raise DownloadError(message, exc_info)\nE           yt_dlp.utils.DownloadError: ERROR: [youtube] c9hWEA9fiNQ: Sign in to confirm you’re not a bot. This helps protect our community. Learn more\n\n/opt/hostedtoolcache/Python/3.9.20/x64/lib/python3.9/site-packages/yt_dlp/YoutubeDL.py:1030: DownloadError","steps":[],"attachments":[{"uid":"9b4c2ca897bf8964","name":"log","source":"9b4c2ca897bf8964.txt","type":"text/plain","size":305}],"parameters":[],"shouldDisplayMessage":true,"stepsCount":0,"attachmentsCount":1,"hasContent":true,"attachmentStep":false},"afterStages":[{"name":"copy_config_to_dir::finish_callback","time":{"start":1729603753548,"stop":1729603753549,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"test_output_dir::0","time":{"start":1729603753548,"stop":1729603753548,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"labels":[{"name":"tag","value":"youtube"},{"name":"parentSuite","value":"lib.youtube"},{"name":"suite","value":"test_y2_video_handler"},{"name":"host","value":"fv-az1391-672"},{"name":"thread","value":"9859-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"lib.youtube.test_y2_video_handler"},{"name":"resultFormat","value":"allure2"}],"parameters":[{"name":"video_url","value":"'https://www.youtube.com/watch?v=c9hWEA9fiNQ'"}],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[{"name":"Test defects","matchedStatuses":[],"flaky":false}],"tags":["youtube"]},"source":"f44d6617368ec34.json","parameterValues":["'https://www.youtube.com/watch?v=c9hWEA9fiNQ'"]}