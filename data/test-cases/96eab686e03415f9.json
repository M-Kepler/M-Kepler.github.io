{"uid":"96eab686e03415f9","name":"test_downloader","fullName":"lib.mqs.pylib.test_downloader#test_downloader","historyId":"e43079ba88d343bb166604b908d3f127","time":{"start":1724489235805,"stop":1724489306686,"duration":70881},"description":"\n    测试通过协程进行下载任务的并发\n    ","descriptionHtml":"<pre><code>测试通过协程进行下载任务的并发\n</code></pre>\n","status":"failed","statusMessage":"AssertionError: assert 39 == 40\n +  where 39 = len(['/home/runner/work/github-runner/github-runner/mypy/tests/lib/mqs/pylib/_out/test_downloader/20190111184024145.png', '/home/runner/work/github-runner/github-runner/mypy/tests/lib/mqs/pylib/_out/test_downloader/1744409-20191115082002679-1253205084.png', '/home/runner/work/github-runner/github-runner/mypy/tests/lib/mqs/pylib/_out/test_downloader/c53a47681c9c24607908cffb905c38d993f8ccc3.png', '/home/runner/work/github-runner/github-runner/mypy/tests/lib/mqs/pylib/_out/test_downloader/902397dda144ad340668b847d4a20cf430ad851e.jpg', '/home/runner/work/github-runner/github-runner/mypy/tests/lib/mqs/pylib/_out/test_downloader/b58f8c5494eef01f119945cbe2fe9925bc317d2a.jpg', '/home/runner/work/github-runner/github-runner/mypy/tests/lib/mqs/pylib/_out/test_downloader/5809200-caf66b935fd00e18.jpg', ...])\n +  and   40 = len(['https://fuss10.elemecdn.com/e/5d/4a731a90594a4af544c0c25941171jpeg.jpeg', 'https://fuss10.elemecdn.com/8/27/f01c15bb73e1ef3793e64e6b7bbccjpeg.jpeg', 'https://cube.elemecdn.com/6/94/4d3ea53c084bad6931a56d5158a48jpeg.jpeg', 'https://fuss10.elemecdn.com/3/28/bbf893f792f03a54408b3b7a7ebf0jpeg.jpeg', 'https://upload-images.jianshu.io/upload_images/5809200-a99419bb94924e6d.jpg', 'https://upload-images.jianshu.io/upload_images/5809200-736bc3917fe92142.jpg', ...])","statusTrace":"test_output_dir = '/home/runner/work/github-runner/github-runner/mypy/tests/lib/mqs/pylib/_out/test_downloader'\n\n    @run_with_analyze('tset_downloader')\n    def test_downloader(test_output_dir):\n        \"\"\"\n        测试通过协程进行下载任务的并发\n        \"\"\"\n        FileUtil.clear_dir(test_output_dir)\n    \n        urls = [\n            \"https://fuss10.elemecdn.com/e/5d/4a731a90594a4af544c0c25941171jpeg.jpeg\",\n            \"https://fuss10.elemecdn.com/8/27/f01c15bb73e1ef3793e64e6b7bbccjpeg.jpeg\",\n            \"https://cube.elemecdn.com/6/94/4d3ea53c084bad6931a56d5158a48jpeg.jpeg\",\n            \"https://fuss10.elemecdn.com/3/28/bbf893f792f03a54408b3b7a7ebf0jpeg.jpeg\",\n            \"https://upload-images.jianshu.io/upload_images/5809200-a99419bb94924e6d.jpg\",\n            \"https://upload-images.jianshu.io/upload_images/5809200-736bc3917fe92142.jpg\",\n            \"https://upload-images.jianshu.io/upload_images/5809200-7fe8c323e533f656.jpg\",\n            \"https://upload-images.jianshu.io/upload_images/5809200-c12521fbde6c705b.jpg\",\n            \"https://upload-images.jianshu.io/upload_images/5809200-caf66b935fd00e18.jpg\",\n            \"https://upload-images.jianshu.io/upload_images/5809200-48dd99da471ffa3f.jpg\",\n            \"https://upload-images.jianshu.io/upload_images/5809200-4de5440a56bff58f.jpg\",\n            \"https://upload-images.jianshu.io/upload_images/5809200-03bbbd715c24750e.jpg\",\n            \"http://e.hiphotos.baidu.com/image/pic/item/a1ec08fa513d2697e542494057fbb2fb4316d81e.jpg\",\n            \"http://c.hiphotos.baidu.com/image/pic/item/30adcbef76094b36de8a2fe5a1cc7cd98d109d99.jpg\",\n            \"http://h.hiphotos.baidu.com/image/pic/item/7c1ed21b0ef41bd5f2c2a9e953da81cb39db3d1d.jpg\",\n            \"http://g.hiphotos.baidu.com/image/pic/item/55e736d12f2eb938d5277fd5d0628535e5dd6f4a.jpg\",\n            \"http://e.hiphotos.baidu.com/image/pic/item/4e4a20a4462309f7e41f5cfe760e0cf3d6cad6ee.jpg\",\n            \"http://b.hiphotos.baidu.com/image/pic/item/9d82d158ccbf6c81b94575cfb93eb13533fa40a2.jpg\",\n            \"http://e.hiphotos.baidu.com/image/pic/item/4bed2e738bd4b31c1badd5a685d6277f9e2ff81e.jpg\",\n            \"http://g.hiphotos.baidu.com/image/pic/item/0d338744ebf81a4c87a3add4d52a6059252da61e.jpg\",\n            \"http://a.hiphotos.baidu.com/image/pic/item/f2deb48f8c5494ee5080c8142ff5e0fe99257e19.jpg\",\n            \"http://f.hiphotos.baidu.com/image/pic/item/4034970a304e251f503521f5a586c9177e3e53f9.jpg\",\n            \"http://b.hiphotos.baidu.com/image/pic/item/279759ee3d6d55fbb3586c0168224f4a20a4dd7e.jpg\",\n            \"http://a.hiphotos.baidu.com/image/pic/item/e824b899a9014c087eb617650e7b02087af4f464.jpg\",\n            \"http://c.hiphotos.baidu.com/image/pic/item/9c16fdfaaf51f3de1e296fa390eef01f3b29795a.jpg\",\n            \"http://d.hiphotos.baidu.com/image/pic/item/b58f8c5494eef01f119945cbe2fe9925bc317d2a.jpg\",\n            \"http://h.hiphotos.baidu.com/image/pic/item/902397dda144ad340668b847d4a20cf430ad851e.jpg\",\n            \"http://b.hiphotos.baidu.com/image/pic/item/359b033b5bb5c9ea5c0e3c23d139b6003bf3b374.jpg\",\n            \"http://a.hiphotos.baidu.com/image/pic/item/8d5494eef01f3a292d2472199d25bc315d607c7c.jpg\",\n            \"http://b.hiphotos.baidu.com/image/pic/item/e824b899a9014c08878b2c4c0e7b02087af4f4a3.jpg\",\n            \"http://g.hiphotos.baidu.com/image/pic/item/6d81800a19d8bc3e770bd00d868ba61ea9d345f2.jpg\",\n            \"https://img2018.cnblogs.com/blog/1607341/201903/1607341-20190304230418358-1599826804.png\",\n            \"https://i1.hdslb.com/bfs/archive/c53a47681c9c24607908cffb905c38d993f8ccc3.png\",\n            \"https://img2018.cnblogs.com/i-beta/1744409/201911/1744409-20191115082002679-1253205084.png\",\n            \"https://img-blog.csdnimg.cn/20190111184024145.png\",\n            \"https://ask.qcloudimg.com/http-save/yehe-6799667/wvxxoisf54.png\",\n            \"https://ask.qcloudimg.com/http-save/yehe-6799667/2f28m2f58r.png\",\n            \"https://ask.qcloudimg.com/http-save/yehe-6799667/58ug0mft91.png\"\n        ]\n    \n        video_urls = [\n            'http://vjs.zencdn.net/v/oceans.mp4',\n            'https://media.w3.org/2010/05/sintel/trailer.mp4'\n        ]\n    \n        all_test_urls = urls + video_urls\n        api = Downloader(urls=all_test_urls,\n                         download_dir=test_output_dir,\n                         per_producer_mission_cnt=9,\n                         consumer_count=9)\n        api.do_download()\n    \n        download_files = FileUtil.list_files_by_ext(\n            test_output_dir, find_exts=None)\n>       assert (len(download_files) == len(all_test_urls))\nE       AssertionError: assert 39 == 40\nE        +  where 39 = len(['/home/runner/work/github-runner/github-runner/mypy/tests/lib/mqs/pylib/_out/test_downloader/20190111184024145.png', '/home/runner/work/github-runner/github-runner/mypy/tests/lib/mqs/pylib/_out/test_downloader/1744409-20191115082002679-1253205084.png', '/home/runner/work/github-runner/github-runner/mypy/tests/lib/mqs/pylib/_out/test_downloader/c53a47681c9c24607908cffb905c38d993f8ccc3.png', '/home/runner/work/github-runner/github-runner/mypy/tests/lib/mqs/pylib/_out/test_downloader/902397dda144ad340668b847d4a20cf430ad851e.jpg', '/home/runner/work/github-runner/github-runner/mypy/tests/lib/mqs/pylib/_out/test_downloader/b58f8c5494eef01f119945cbe2fe9925bc317d2a.jpg', '/home/runner/work/github-runner/github-runner/mypy/tests/lib/mqs/pylib/_out/test_downloader/5809200-caf66b935fd00e18.jpg', ...])\nE        +  and   40 = len(['https://fuss10.elemecdn.com/e/5d/4a731a90594a4af544c0c25941171jpeg.jpeg', 'https://fuss10.elemecdn.com/8/27/f01c15bb73e1ef3793e64e6b7bbccjpeg.jpeg', 'https://cube.elemecdn.com/6/94/4d3ea53c084bad6931a56d5158a48jpeg.jpeg', 'https://fuss10.elemecdn.com/3/28/bbf893f792f03a54408b3b7a7ebf0jpeg.jpeg', 'https://upload-images.jianshu.io/upload_images/5809200-a99419bb94924e6d.jpg', 'https://upload-images.jianshu.io/upload_images/5809200-736bc3917fe92142.jpg', ...])\n\nmypy/tests/lib/mqs/pylib/test_downloader.py:68: AssertionError","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"event_loop_policy","time":{"start":1724481546390,"stop":1724481546390,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"copy_config_to_dir","time":{"start":1724489235802,"stop":1724489235804,"duration":2},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"test_output_dir","time":{"start":1724489235804,"stop":1724489235804,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"testStage":{"description":"\n    测试通过协程进行下载任务的并发\n    ","status":"failed","statusMessage":"AssertionError: assert 39 == 40\n +  where 39 = len(['/home/runner/work/github-runner/github-runner/mypy/tests/lib/mqs/pylib/_out/test_downloader/20190111184024145.png', '/home/runner/work/github-runner/github-runner/mypy/tests/lib/mqs/pylib/_out/test_downloader/1744409-20191115082002679-1253205084.png', '/home/runner/work/github-runner/github-runner/mypy/tests/lib/mqs/pylib/_out/test_downloader/c53a47681c9c24607908cffb905c38d993f8ccc3.png', '/home/runner/work/github-runner/github-runner/mypy/tests/lib/mqs/pylib/_out/test_downloader/902397dda144ad340668b847d4a20cf430ad851e.jpg', '/home/runner/work/github-runner/github-runner/mypy/tests/lib/mqs/pylib/_out/test_downloader/b58f8c5494eef01f119945cbe2fe9925bc317d2a.jpg', '/home/runner/work/github-runner/github-runner/mypy/tests/lib/mqs/pylib/_out/test_downloader/5809200-caf66b935fd00e18.jpg', ...])\n +  and   40 = len(['https://fuss10.elemecdn.com/e/5d/4a731a90594a4af544c0c25941171jpeg.jpeg', 'https://fuss10.elemecdn.com/8/27/f01c15bb73e1ef3793e64e6b7bbccjpeg.jpeg', 'https://cube.elemecdn.com/6/94/4d3ea53c084bad6931a56d5158a48jpeg.jpeg', 'https://fuss10.elemecdn.com/3/28/bbf893f792f03a54408b3b7a7ebf0jpeg.jpeg', 'https://upload-images.jianshu.io/upload_images/5809200-a99419bb94924e6d.jpg', 'https://upload-images.jianshu.io/upload_images/5809200-736bc3917fe92142.jpg', ...])","statusTrace":"test_output_dir = '/home/runner/work/github-runner/github-runner/mypy/tests/lib/mqs/pylib/_out/test_downloader'\n\n    @run_with_analyze('tset_downloader')\n    def test_downloader(test_output_dir):\n        \"\"\"\n        测试通过协程进行下载任务的并发\n        \"\"\"\n        FileUtil.clear_dir(test_output_dir)\n    \n        urls = [\n            \"https://fuss10.elemecdn.com/e/5d/4a731a90594a4af544c0c25941171jpeg.jpeg\",\n            \"https://fuss10.elemecdn.com/8/27/f01c15bb73e1ef3793e64e6b7bbccjpeg.jpeg\",\n            \"https://cube.elemecdn.com/6/94/4d3ea53c084bad6931a56d5158a48jpeg.jpeg\",\n            \"https://fuss10.elemecdn.com/3/28/bbf893f792f03a54408b3b7a7ebf0jpeg.jpeg\",\n            \"https://upload-images.jianshu.io/upload_images/5809200-a99419bb94924e6d.jpg\",\n            \"https://upload-images.jianshu.io/upload_images/5809200-736bc3917fe92142.jpg\",\n            \"https://upload-images.jianshu.io/upload_images/5809200-7fe8c323e533f656.jpg\",\n            \"https://upload-images.jianshu.io/upload_images/5809200-c12521fbde6c705b.jpg\",\n            \"https://upload-images.jianshu.io/upload_images/5809200-caf66b935fd00e18.jpg\",\n            \"https://upload-images.jianshu.io/upload_images/5809200-48dd99da471ffa3f.jpg\",\n            \"https://upload-images.jianshu.io/upload_images/5809200-4de5440a56bff58f.jpg\",\n            \"https://upload-images.jianshu.io/upload_images/5809200-03bbbd715c24750e.jpg\",\n            \"http://e.hiphotos.baidu.com/image/pic/item/a1ec08fa513d2697e542494057fbb2fb4316d81e.jpg\",\n            \"http://c.hiphotos.baidu.com/image/pic/item/30adcbef76094b36de8a2fe5a1cc7cd98d109d99.jpg\",\n            \"http://h.hiphotos.baidu.com/image/pic/item/7c1ed21b0ef41bd5f2c2a9e953da81cb39db3d1d.jpg\",\n            \"http://g.hiphotos.baidu.com/image/pic/item/55e736d12f2eb938d5277fd5d0628535e5dd6f4a.jpg\",\n            \"http://e.hiphotos.baidu.com/image/pic/item/4e4a20a4462309f7e41f5cfe760e0cf3d6cad6ee.jpg\",\n            \"http://b.hiphotos.baidu.com/image/pic/item/9d82d158ccbf6c81b94575cfb93eb13533fa40a2.jpg\",\n            \"http://e.hiphotos.baidu.com/image/pic/item/4bed2e738bd4b31c1badd5a685d6277f9e2ff81e.jpg\",\n            \"http://g.hiphotos.baidu.com/image/pic/item/0d338744ebf81a4c87a3add4d52a6059252da61e.jpg\",\n            \"http://a.hiphotos.baidu.com/image/pic/item/f2deb48f8c5494ee5080c8142ff5e0fe99257e19.jpg\",\n            \"http://f.hiphotos.baidu.com/image/pic/item/4034970a304e251f503521f5a586c9177e3e53f9.jpg\",\n            \"http://b.hiphotos.baidu.com/image/pic/item/279759ee3d6d55fbb3586c0168224f4a20a4dd7e.jpg\",\n            \"http://a.hiphotos.baidu.com/image/pic/item/e824b899a9014c087eb617650e7b02087af4f464.jpg\",\n            \"http://c.hiphotos.baidu.com/image/pic/item/9c16fdfaaf51f3de1e296fa390eef01f3b29795a.jpg\",\n            \"http://d.hiphotos.baidu.com/image/pic/item/b58f8c5494eef01f119945cbe2fe9925bc317d2a.jpg\",\n            \"http://h.hiphotos.baidu.com/image/pic/item/902397dda144ad340668b847d4a20cf430ad851e.jpg\",\n            \"http://b.hiphotos.baidu.com/image/pic/item/359b033b5bb5c9ea5c0e3c23d139b6003bf3b374.jpg\",\n            \"http://a.hiphotos.baidu.com/image/pic/item/8d5494eef01f3a292d2472199d25bc315d607c7c.jpg\",\n            \"http://b.hiphotos.baidu.com/image/pic/item/e824b899a9014c08878b2c4c0e7b02087af4f4a3.jpg\",\n            \"http://g.hiphotos.baidu.com/image/pic/item/6d81800a19d8bc3e770bd00d868ba61ea9d345f2.jpg\",\n            \"https://img2018.cnblogs.com/blog/1607341/201903/1607341-20190304230418358-1599826804.png\",\n            \"https://i1.hdslb.com/bfs/archive/c53a47681c9c24607908cffb905c38d993f8ccc3.png\",\n            \"https://img2018.cnblogs.com/i-beta/1744409/201911/1744409-20191115082002679-1253205084.png\",\n            \"https://img-blog.csdnimg.cn/20190111184024145.png\",\n            \"https://ask.qcloudimg.com/http-save/yehe-6799667/wvxxoisf54.png\",\n            \"https://ask.qcloudimg.com/http-save/yehe-6799667/2f28m2f58r.png\",\n            \"https://ask.qcloudimg.com/http-save/yehe-6799667/58ug0mft91.png\"\n        ]\n    \n        video_urls = [\n            'http://vjs.zencdn.net/v/oceans.mp4',\n            'https://media.w3.org/2010/05/sintel/trailer.mp4'\n        ]\n    \n        all_test_urls = urls + video_urls\n        api = Downloader(urls=all_test_urls,\n                         download_dir=test_output_dir,\n                         per_producer_mission_cnt=9,\n                         consumer_count=9)\n        api.do_download()\n    \n        download_files = FileUtil.list_files_by_ext(\n            test_output_dir, find_exts=None)\n>       assert (len(download_files) == len(all_test_urls))\nE       AssertionError: assert 39 == 40\nE        +  where 39 = len(['/home/runner/work/github-runner/github-runner/mypy/tests/lib/mqs/pylib/_out/test_downloader/20190111184024145.png', '/home/runner/work/github-runner/github-runner/mypy/tests/lib/mqs/pylib/_out/test_downloader/1744409-20191115082002679-1253205084.png', '/home/runner/work/github-runner/github-runner/mypy/tests/lib/mqs/pylib/_out/test_downloader/c53a47681c9c24607908cffb905c38d993f8ccc3.png', '/home/runner/work/github-runner/github-runner/mypy/tests/lib/mqs/pylib/_out/test_downloader/902397dda144ad340668b847d4a20cf430ad851e.jpg', '/home/runner/work/github-runner/github-runner/mypy/tests/lib/mqs/pylib/_out/test_downloader/b58f8c5494eef01f119945cbe2fe9925bc317d2a.jpg', '/home/runner/work/github-runner/github-runner/mypy/tests/lib/mqs/pylib/_out/test_downloader/5809200-caf66b935fd00e18.jpg', ...])\nE        +  and   40 = len(['https://fuss10.elemecdn.com/e/5d/4a731a90594a4af544c0c25941171jpeg.jpeg', 'https://fuss10.elemecdn.com/8/27/f01c15bb73e1ef3793e64e6b7bbccjpeg.jpeg', 'https://cube.elemecdn.com/6/94/4d3ea53c084bad6931a56d5158a48jpeg.jpeg', 'https://fuss10.elemecdn.com/3/28/bbf893f792f03a54408b3b7a7ebf0jpeg.jpeg', 'https://upload-images.jianshu.io/upload_images/5809200-a99419bb94924e6d.jpg', 'https://upload-images.jianshu.io/upload_images/5809200-736bc3917fe92142.jpg', ...])\n\nmypy/tests/lib/mqs/pylib/test_downloader.py:68: AssertionError","steps":[],"attachments":[{"uid":"ac00a90bab34e6f6","name":"log","source":"ac00a90bab34e6f6.txt","type":"text/plain","size":1090}],"parameters":[],"shouldDisplayMessage":true,"stepsCount":0,"attachmentsCount":1,"hasContent":true,"attachmentStep":false},"afterStages":[{"name":"test_output_dir::0","time":{"start":1724489306690,"stop":1724489306690,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"copy_config_to_dir::finish_callback","time":{"start":1724489306691,"stop":1724489306691,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"labels":[{"name":"parentSuite","value":"lib.mqs.pylib"},{"name":"suite","value":"test_downloader"},{"name":"host","value":"fv-az775-20"},{"name":"thread","value":"8935-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"lib.mqs.pylib.test_downloader"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[{"name":"Product defects","matchedStatuses":[],"flaky":false}],"tags":[]},"source":"96eab686e03415f9.json","parameterValues":[]}