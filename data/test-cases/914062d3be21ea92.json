{"uid":"914062d3be21ea92","name":"test_get_hot_douyin","fullName":"lib.douyin.test_get_hot_douyin#test_get_hot_douyin","historyId":"6fd327effe51b45a4f9211c3976674de","time":{"start":1710206040126,"stop":1710206042341,"duration":2215},"status":"skipped","statusMessage":"XFAIL API 有限制，可能会获取 cookie 失败\n\nKeyError: 'data'","statusTrace":"test_output_dir = '/home/runner/work/Python/Python/mypy/tests/lib/douyin/_out/test_get_hot_douyin'\n\n    @pytest.mark.xfail(reason='API 有限制，可能会获取 cookie 失败')\n    def test_get_hot_douyin(test_output_dir):\n>       HotDouyinHandler(test_output_dir).handle()\n\nmypy/tests/lib/douyin/test_get_hot_douyin.py:12: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nmypy/lib/douyin/get_hot_video.py:297: in handle\n    raise ex\nmypy/lib/douyin/get_hot_video.py:287: in handle\n    video_url = self._get_douyin_hot_music_video()\nmypy/lib/douyin/get_hot_video.py:198: in _get_douyin_hot_music_video\n    jd, res = self._get_douyin_music_video()\nmypy/lib/douyin/get_hot_video.py:154: in _get_douyin_music_video\n    cookie_str=self._get_web_cookie())\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <mypy.lib.douyin.get_hot_video.HotDouyinHandler object at 0x7f845bf933a0>\n\n    def _get_web_cookie(self):\n        \"\"\"\n        获取 cookie\n        \"\"\"\n    \n        header = {\n            'cid': spider_cfg.cid,\n            'timestamp': FileUtil.get_timestamp(),\n            'user-agent': 'okhttp/3.10.0.12'}\n        resp = None\n        try:\n            resp = requests.post(url=spider_cfg.get_cookie_url,\n                                 headers=header,\n                                 data={'sign': self._set_sign()},\n                                 timeout=spider_cfg.http_timeout).json()\n>           return resp['data'][0]['cookie']\nE           KeyError: 'data'\n\nmypy/lib/douyin/get_hot_video.py:87: KeyError","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"test_output_dir","time":{"start":1710206040126,"stop":1710206040126,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"testStage":{"status":"skipped","statusMessage":"XFAIL API 有限制，可能会获取 cookie 失败\n\nKeyError: 'data'","statusTrace":"test_output_dir = '/home/runner/work/Python/Python/mypy/tests/lib/douyin/_out/test_get_hot_douyin'\n\n    @pytest.mark.xfail(reason='API 有限制，可能会获取 cookie 失败')\n    def test_get_hot_douyin(test_output_dir):\n>       HotDouyinHandler(test_output_dir).handle()\n\nmypy/tests/lib/douyin/test_get_hot_douyin.py:12: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nmypy/lib/douyin/get_hot_video.py:297: in handle\n    raise ex\nmypy/lib/douyin/get_hot_video.py:287: in handle\n    video_url = self._get_douyin_hot_music_video()\nmypy/lib/douyin/get_hot_video.py:198: in _get_douyin_hot_music_video\n    jd, res = self._get_douyin_music_video()\nmypy/lib/douyin/get_hot_video.py:154: in _get_douyin_music_video\n    cookie_str=self._get_web_cookie())\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <mypy.lib.douyin.get_hot_video.HotDouyinHandler object at 0x7f845bf933a0>\n\n    def _get_web_cookie(self):\n        \"\"\"\n        获取 cookie\n        \"\"\"\n    \n        header = {\n            'cid': spider_cfg.cid,\n            'timestamp': FileUtil.get_timestamp(),\n            'user-agent': 'okhttp/3.10.0.12'}\n        resp = None\n        try:\n            resp = requests.post(url=spider_cfg.get_cookie_url,\n                                 headers=header,\n                                 data={'sign': self._set_sign()},\n                                 timeout=spider_cfg.http_timeout).json()\n>           return resp['data'][0]['cookie']\nE           KeyError: 'data'\n\nmypy/lib/douyin/get_hot_video.py:87: KeyError","steps":[],"attachments":[{"uid":"4770dce571865919","name":"log","source":"4770dce571865919.txt","type":"text/plain","size":1311}],"parameters":[],"shouldDisplayMessage":true,"stepsCount":0,"attachmentsCount":1,"hasContent":true,"attachmentStep":false},"afterStages":[{"name":"test_output_dir::0","time":{"start":1710206042366,"stop":1710206042367,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"labels":[{"name":"tag","value":"@pytest.mark.xfail(reason='API 有限制，可能会获取 cookie 失败')"},{"name":"tag","value":"douyin"},{"name":"parentSuite","value":"lib.douyin"},{"name":"suite","value":"test_get_hot_douyin"},{"name":"host","value":"fv-az702-107"},{"name":"thread","value":"7463-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"lib.douyin.test_get_hot_douyin"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[],"tags":["@pytest.mark.xfail(reason='API 有限制，可能会获取 cookie 失败')","douyin"]},"source":"914062d3be21ea92.json","parameterValues":[]}