{"uid":"e36997bdd176d76f","name":"test_ppt2douyin","fullName":"apps.ppt2douyin.test_ppt2douyin#test_ppt2douyin","historyId":"af4409226fdd64dbf01fb563e64e37a2","time":{"start":1712576385844,"stop":1712576614812,"duration":228968},"status":"broken","statusMessage":"mypy.lib.douyin.exceptions.PublishFail","statusTrace":"self = <mypy.lib.douyin.publisher.DouyinPublishHelper object at 0x7fb0ccc313d0>\nplaywright = <playwright._impl._playwright.Playwright object at 0x7fb0ccb986a0>\n\n    async def publish_mission(self, playwright: Playwright):\n        \"\"\"\n        视频发布任务\n        \"\"\"\n        # 浏览器上下文\n        browser, context, page = await PlaywrightCommon(\n            self._cookie_filepath).launch_browser(playwright)\n        try:\n            # 判断登录状态\n            is_login = await self._check_login_status(page)\n            if not is_login:\n                return\n    \n            # 上传视频\n            await self._upload_video(page)\n            # 填写信息\n            # await self._set_title(page) # 在 _set_description 处理了\n            await self._set_description(page)\n            if self._pub_cfg.collection_name:\n>               await self._set_collection(page)\n\nmypy/lib/douyin/publisher.py:518: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nmypy/lib/douyin/publisher.py:189: in _set_collection\n    selected_collection = await self._get_collection(page)\nmypy/lib/douyin/publisher.py:128: in _get_collection\n    await page.wait_for_selector(self._playwright_cfg.coll_list_loc)\n/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/playwright/async_api/_generated.py:7786: in wait_for_selector\n    await self._impl_obj.wait_for_selector(\n/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/playwright/_impl/_page.py:373: in wait_for_selector\n    return await self._main_frame.wait_for_selector(**locals_to_params(locals()))\n/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/playwright/_impl/_frame.py:323: in wait_for_selector\n    await self._channel.send(\"waitForSelector\", locals_to_params(locals()))\n/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/playwright/_impl/_connection.py:59: in send\n    return await self._connection.wrap_api_call(\n/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/playwright/_impl/_connection.py:509: in wrap_api_call\n    return await cb()\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <playwright._impl._connection.Channel object at 0x7fb0cc8fa640>\nmethod = 'waitForSelector'\nparams = {'selector': '.collection-option-tooltip--2n26E'}\nreturn_as_dict = False\n\n    async def inner_send(\n        self, method: str, params: Optional[Dict], return_as_dict: bool\n    ) -> Any:\n        if params is None:\n            params = {}\n        if self._connection._error:\n            error = self._connection._error\n            self._connection._error = None\n            raise error\n        callback = self._connection._send_message_to_server(\n            self._object, method, _filter_none(params)\n        )\n        done, _ = await asyncio.wait(\n            {\n                self._connection._transport.on_error_future,\n                callback.future,\n            },\n            return_when=asyncio.FIRST_COMPLETED,\n        )\n        if not callback.future.done():\n            callback.future.cancel()\n>       result = next(iter(done)).result()\nE       playwright._impl._errors.TimeoutError: Timeout 120000ms exceeded.\n\n/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/playwright/_impl/_connection.py:97: TimeoutError\n\nThe above exception was the direct cause of the following exception:\n\n    @pytest.mark.app\n    @pytest.mark.douyin\n    @time_spen\n    def test_ppt2douyin():\n>       main(work_path=curr_dir)\n\nmypy/tests/apps/ppt2douyin/test_ppt2douyin.py:16: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nmypy/apps/ppt2douyin/main.py:25: in main\n    raise ex\nmypy/apps/ppt2douyin/main.py:22: in main\n    PPTPublishHelper(work_path).batch_publish()\nmypy/apps/ppt2douyin/video2douyin.py:108: in batch_publish\n    self._publish_to_douyin(pub_cfg)\nmypy/apps/ppt2douyin/video2douyin.py:39: in _publish_to_douyin\n    raise ex\nmypy/apps/ppt2douyin/video2douyin.py:35: in _publish_to_douyin\n    self._publish_app.publish(video_path=find_result[0],\nmypy/lib/douyin/publisher.py:719: in publish\n    asyncio.run(app.do_publish())\n/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/asyncio/runners.py:44: in run\n    return loop.run_until_complete(main)\n/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/asyncio/base_events.py:616: in run_until_complete\n    return future.result()\nmypy/lib/douyin/publisher.py:542: in do_publish\n    async for attempt in AsyncRetrying(\n/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/tenacity/_asyncio.py:71: in __anext__\n    do = self.iter(retry_state=self._retry_state)\n/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/tenacity/__init__.py:314: in iter\n    return fut.result()\n/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/concurrent/futures/_base.py:437: in result\n    return self.__get_result()\n/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/concurrent/futures/_base.py:389: in __get_result\n    raise self._exception\nmypy/lib/douyin/publisher.py:550: in do_publish\n    await self.publish_mission(playwright)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <mypy.lib.douyin.publisher.DouyinPublishHelper object at 0x7fb0ccc313d0>\nplaywright = <playwright._impl._playwright.Playwright object at 0x7fb0ccb986a0>\n\n    async def publish_mission(self, playwright: Playwright):\n        \"\"\"\n        视频发布任务\n        \"\"\"\n        # 浏览器上下文\n        browser, context, page = await PlaywrightCommon(\n            self._cookie_filepath).launch_browser(playwright)\n        try:\n            # 判断登录状态\n            is_login = await self._check_login_status(page)\n            if not is_login:\n                return\n    \n            # 上传视频\n            await self._upload_video(page)\n            # 填写信息\n            # await self._set_title(page) # 在 _set_description 处理了\n            await self._set_description(page)\n            if self._pub_cfg.collection_name:\n                await self._set_collection(page)\n            if self._pub_cfg.location:\n                await self._set_location(page)\n            if self._pub_cfg.visible:\n                await self._set_visible(page)\n            await self._set_download_permission(page)\n            await self._set_publish_time(page)\n            await self._set_coverage(page)\n            # 发布\n            if DEBUG:\n                LOG.warning('调试模式下，不触发发布操作')\n                return\n            await self._publish(page)\n        except Exception as ex:\n            LOG.exception('❌❌❌《%s》发布异常 ❌❌❌', self._publish_title)\n>           raise PublishFail() from ex\nE           mypy.lib.douyin.exceptions.PublishFail\n\nmypy/lib/douyin/publisher.py:533: PublishFail","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[],"testStage":{"status":"broken","statusMessage":"mypy.lib.douyin.exceptions.PublishFail","statusTrace":"self = <mypy.lib.douyin.publisher.DouyinPublishHelper object at 0x7fb0ccc313d0>\nplaywright = <playwright._impl._playwright.Playwright object at 0x7fb0ccb986a0>\n\n    async def publish_mission(self, playwright: Playwright):\n        \"\"\"\n        视频发布任务\n        \"\"\"\n        # 浏览器上下文\n        browser, context, page = await PlaywrightCommon(\n            self._cookie_filepath).launch_browser(playwright)\n        try:\n            # 判断登录状态\n            is_login = await self._check_login_status(page)\n            if not is_login:\n                return\n    \n            # 上传视频\n            await self._upload_video(page)\n            # 填写信息\n            # await self._set_title(page) # 在 _set_description 处理了\n            await self._set_description(page)\n            if self._pub_cfg.collection_name:\n>               await self._set_collection(page)\n\nmypy/lib/douyin/publisher.py:518: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nmypy/lib/douyin/publisher.py:189: in _set_collection\n    selected_collection = await self._get_collection(page)\nmypy/lib/douyin/publisher.py:128: in _get_collection\n    await page.wait_for_selector(self._playwright_cfg.coll_list_loc)\n/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/playwright/async_api/_generated.py:7786: in wait_for_selector\n    await self._impl_obj.wait_for_selector(\n/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/playwright/_impl/_page.py:373: in wait_for_selector\n    return await self._main_frame.wait_for_selector(**locals_to_params(locals()))\n/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/playwright/_impl/_frame.py:323: in wait_for_selector\n    await self._channel.send(\"waitForSelector\", locals_to_params(locals()))\n/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/playwright/_impl/_connection.py:59: in send\n    return await self._connection.wrap_api_call(\n/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/playwright/_impl/_connection.py:509: in wrap_api_call\n    return await cb()\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <playwright._impl._connection.Channel object at 0x7fb0cc8fa640>\nmethod = 'waitForSelector'\nparams = {'selector': '.collection-option-tooltip--2n26E'}\nreturn_as_dict = False\n\n    async def inner_send(\n        self, method: str, params: Optional[Dict], return_as_dict: bool\n    ) -> Any:\n        if params is None:\n            params = {}\n        if self._connection._error:\n            error = self._connection._error\n            self._connection._error = None\n            raise error\n        callback = self._connection._send_message_to_server(\n            self._object, method, _filter_none(params)\n        )\n        done, _ = await asyncio.wait(\n            {\n                self._connection._transport.on_error_future,\n                callback.future,\n            },\n            return_when=asyncio.FIRST_COMPLETED,\n        )\n        if not callback.future.done():\n            callback.future.cancel()\n>       result = next(iter(done)).result()\nE       playwright._impl._errors.TimeoutError: Timeout 120000ms exceeded.\n\n/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/playwright/_impl/_connection.py:97: TimeoutError\n\nThe above exception was the direct cause of the following exception:\n\n    @pytest.mark.app\n    @pytest.mark.douyin\n    @time_spen\n    def test_ppt2douyin():\n>       main(work_path=curr_dir)\n\nmypy/tests/apps/ppt2douyin/test_ppt2douyin.py:16: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nmypy/apps/ppt2douyin/main.py:25: in main\n    raise ex\nmypy/apps/ppt2douyin/main.py:22: in main\n    PPTPublishHelper(work_path).batch_publish()\nmypy/apps/ppt2douyin/video2douyin.py:108: in batch_publish\n    self._publish_to_douyin(pub_cfg)\nmypy/apps/ppt2douyin/video2douyin.py:39: in _publish_to_douyin\n    raise ex\nmypy/apps/ppt2douyin/video2douyin.py:35: in _publish_to_douyin\n    self._publish_app.publish(video_path=find_result[0],\nmypy/lib/douyin/publisher.py:719: in publish\n    asyncio.run(app.do_publish())\n/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/asyncio/runners.py:44: in run\n    return loop.run_until_complete(main)\n/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/asyncio/base_events.py:616: in run_until_complete\n    return future.result()\nmypy/lib/douyin/publisher.py:542: in do_publish\n    async for attempt in AsyncRetrying(\n/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/tenacity/_asyncio.py:71: in __anext__\n    do = self.iter(retry_state=self._retry_state)\n/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/tenacity/__init__.py:314: in iter\n    return fut.result()\n/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/concurrent/futures/_base.py:437: in result\n    return self.__get_result()\n/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/concurrent/futures/_base.py:389: in __get_result\n    raise self._exception\nmypy/lib/douyin/publisher.py:550: in do_publish\n    await self.publish_mission(playwright)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <mypy.lib.douyin.publisher.DouyinPublishHelper object at 0x7fb0ccc313d0>\nplaywright = <playwright._impl._playwright.Playwright object at 0x7fb0ccb986a0>\n\n    async def publish_mission(self, playwright: Playwright):\n        \"\"\"\n        视频发布任务\n        \"\"\"\n        # 浏览器上下文\n        browser, context, page = await PlaywrightCommon(\n            self._cookie_filepath).launch_browser(playwright)\n        try:\n            # 判断登录状态\n            is_login = await self._check_login_status(page)\n            if not is_login:\n                return\n    \n            # 上传视频\n            await self._upload_video(page)\n            # 填写信息\n            # await self._set_title(page) # 在 _set_description 处理了\n            await self._set_description(page)\n            if self._pub_cfg.collection_name:\n                await self._set_collection(page)\n            if self._pub_cfg.location:\n                await self._set_location(page)\n            if self._pub_cfg.visible:\n                await self._set_visible(page)\n            await self._set_download_permission(page)\n            await self._set_publish_time(page)\n            await self._set_coverage(page)\n            # 发布\n            if DEBUG:\n                LOG.warning('调试模式下，不触发发布操作')\n                return\n            await self._publish(page)\n        except Exception as ex:\n            LOG.exception('❌❌❌《%s》发布异常 ❌❌❌', self._publish_title)\n>           raise PublishFail() from ex\nE           mypy.lib.douyin.exceptions.PublishFail\n\nmypy/lib/douyin/publisher.py:533: PublishFail","steps":[],"attachments":[{"uid":"60c35419f4332b7","name":"log","source":"60c35419f4332b7.txt","type":"text/plain","size":15894}],"parameters":[],"shouldDisplayMessage":true,"stepsCount":0,"attachmentsCount":1,"hasContent":true,"attachmentStep":false},"afterStages":[],"labels":[{"name":"tag","value":"douyin"},{"name":"tag","value":"app"},{"name":"parentSuite","value":"apps.ppt2douyin"},{"name":"suite","value":"test_ppt2douyin"},{"name":"host","value":"fv-az985-89"},{"name":"thread","value":"7147-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"apps.ppt2douyin.test_ppt2douyin"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[{"name":"Test defects","matchedStatuses":[],"flaky":false}],"tags":["app","douyin"]},"source":"e36997bdd176d76f.json","parameterValues":[]}