- [参考资料](#参考资料)
- [`DNS`](#dns)
  - [域名解析过程](#域名解析过程)
  - [递归查询与迭代查询](#递归查询与迭代查询)

## 参考资料

## `DNS`

### 域名解析过程

![alt](https://mmbiz.qpic.cn/mmbiz_png/NdsdouZwicafEzHnoaNaynIh3vHS1ic7Sa3PRRvfVVrMFHib3MsFNcpvOAWH9jOPTs5H9qWyQH8tHrXdkfleGGmEg/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

- 在浏览器中输入域名，操作系统会`先检查自己【本地 hosts 文件】`是否有这个网址映射关系，如果有，就先调用这个 IP 地址映射，完成域名解析

- 如果 hosts 里没有这个域名的映射，则`查找【本地DNS解析器缓存】`，是否有这个网址映射关系，如果有，直接返回，完成域名解析

- 如果 hosts 与本地 DNS 解析器缓存都没有相应的网址映射关系，首先会找 TCP/IP 参数中设置的首选 DNS 服务器，在此我们叫它本地 DNS 服务器，`向【本地DNS服务器发起查询】`，此服务器收到查询时，`检查服务器配置区域资源中，则返回解析结果给客户机`，比如你要找 `.xx` 而我就是 `.xx` 我可以直接解析域名对应的 IP 给你，完成域名解析，此解析具有权威性

- 如果要查询的域名，不由本地 DNS 服务器区域解析，`但该服务器已缓存了此网址映射关系，则调用这个IP地址映射，完成域名解析`，此解析不具有权威性

- 如果本地 DNS 服务器本地区域文件与缓存解析都失效，则根据本地 DNS 服务器的设置（是否设置转发器）进行查询，`包括【递归查询和非递归查询】两种方式`

### 递归查询与迭代查询

> [DNS 递归查询与迭代查询](https://www.cnblogs.com/qingdaofu/p/7399670.html)

- 递归查询

  > 交给我就行了，要么成功要么失败，我不知道我还可以帮你问问我的上级

  ![alt](https://s4.51cto.com/attachment/201304/143318898.png)

  - 如果主机所询问的本地域名服务器不知道被查询的域名的 IP 地址，那么本地域名服务器就以 DNS 客户的身份，`向其它根域名服务器继续发出查询请求报文`(即替主机继续查询)，而`不是让主机自己进行下一步查询`。

  - 递归查询返回的查询结果或者是所要查询的 IP 地址，或者是报错，表示无法查询到所需的 IP 地址

- 迭代查询

  > 告诉你下一步你该去哪查询

  ![alt](https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fdominic.blog.chinaunix.net%2Fattachment%2F201309%2F16%2F10659021_1379292200BKjO.jpg&refer=http%3A%2F%2Fdominic.blog.chinaunix.net&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=jpeg?sec=1624633841&t=915ae3a4feb0dada9e9509cbfe61de5c)

  - 当根域名服务器收到本地域名服务器发出的迭代查询请求报文时，`要么给出所要查询的IP地址，要么告诉本地服务器：“你下一步应当向哪一个域名服务器进行查询”`

  - 然后让本地服务器进行后续的查询。根域名服务器通常是把自己知道的顶级域名服务器的 IP 地址告诉本地域名服务器，让本地域名服务器再向顶级域名服务器查询。

  - 顶级域名服务器在收到本地域名服务器的查询请求后，要么给出所要查询的 IP 地址，要么告诉本地服务器下一步应当向哪一个权限域名服务器进行查询。

  - 最后，知道了所要解析的 IP 地址或报错，然后把这个结果返回给发起查询的主机
