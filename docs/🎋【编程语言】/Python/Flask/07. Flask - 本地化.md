- [参考资料](#参考资料)
- [本地化](#本地化)
  - [jinja2 模板本地化](#jinja2-模板本地化)
  - [`render_template`](#render_template)
- [其他](#其他)

# 参考资料

- [flask.jinja2 模板中自动转义和取消转义的分析](https://blog.csdn.net/fanny_git/article/details/78072690)

- [jinja2 模板本地化](http://www.ttlsa.com/python/flask-jinja2-template-engine-localization/)

# 本地化

> 参考 `python-module.py` 的 `gettext` 模块

## jinja2 模板本地化

- app.py

  ```py
  from flask import Flask, render_template
  import gettext
  app = Flask(__name__)
  app.jinja_env.add_extension('jinja2.ext.i18n')
  gettext.install('lang', 'locale', unicode=True)
  translations = gettext.translation('lang', 'locale', languages=['zh_CN'])
  translations.install(True)
  app.jinja_env.install_gettext_translations(translations, newstyle=True)

  @app.route('/')
  def index():
    return render_template('hello.html', name='<em>flask</em>')

  @app.route('/hello')
  @app.route('/hello/<name>')
  def hello(name=None):
    return render_template('hello-7.html', name=name)

  if __name__ == '__main__':
    app.run(host='0.0.0.0', debug=True)
  ```

- hello.html

  ```html
  <title>Hello Sample</title>
  {% if name %}
  <h1>{% trans user=name %}Hello {{ user }}!{% endtrans %}</h1>
  {# Old Style #} {#
  <h1>{{ _('Hello %(user)s!')|format(user=name) }}</h1>
  #} {# New Style #}
  <h1>{{ _('Hello %(user)s!', user=name) }}</h1>
  {% else %}
  <h1>{{ _('Hello World!') }}</h1>
  {% endif %}

  <div>
    {% set items = [1,2,3,4,5] %} {{ ngettext('%(num)d item', '%(num)d items',
    items|count) }}<br />
    {{ ngettext('%(num)d item', '%(num)d items', items|first) }}
  </div>
  ```

## `render_template`

> [Jinja2 常用模板语言](https://blog.csdn.net/kylinxjd/article/details/94563427)

- 变量替换

  ```py
  kw_args = {
    "user_name": "huangjinjie",
    "age": 25
  }
  render_template("/index.html", **kw_args)
  ```

- `if` 语句

  ```html
  {% if title %}
  <!-- 语句块1 -->
  <!-- {% %} 这样代表控制语句，意思是如果有传入 title 变量，则显示 title-microblog -->
  {% elif 条件2 %}
  <!-- 语句块2 -->
  {% else %}
  <!-- 不符合所有条件 -->
  {% endif %}
  ```

  ```html
  <html>
  <head>
    <!--
    -->
    {% if title %}
    <title>{{post.body}}</b></p>
    {% endfor %}
  </body>
  </html>
  ```

- `for` 循环

  ```py
  def test():
      list1 = []
      return render_template('temp1.html', list1=list1)
  ```

  ```html
  {% for item in list %}
  <!-- list不空是执行 -->
  {% else %}
  <!-- list为空时执行的默认语句块 -->
  {% endfor %}
  ```

- `while` 语句

- 传递函数

  ```py
  # 定义一个函数,把它传递给前端
  def a_b_sum(a,b):
      return a+b

  @app.route("/")
  def index():
      return render_template("index.html", tag=a_b_sum)
  ```

  ```html
  <!-- index.html -->
  <!DOCTYPE html>
  <html lang="en">
    <head>
      <meta charset="UTF-8" />
      <title>Title</title>
    </head>
    <body>
      {{ tag }}
      <br />
      {{ tag(99,1) }}
    </body>
  </html>
  ```

# 其他
